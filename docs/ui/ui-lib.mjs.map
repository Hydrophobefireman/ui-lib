{"version":3,"file":"ui-lib.mjs","sources":["../src/util.js","../src/create-element.js","../src/lifeCycleRunner.js","../src/diff/dom.js","../src/diff/children.js","../src/component.js","../src/diff/toSimpleVnode.js","../src/diff/index.js","../src/render.js","../src/pkg/AsyncComponent/AsyncComponent.js","../src/pkg/router/router.js"],"sourcesContent":["/**\n * @type {(cb) => any}\n * @returns {Promise<any>}\n */\nexport const defer =\n  typeof Promise == \"function\"\n    ? Promise.prototype.then.bind(Promise.resolve())\n    : setTimeout;\n\nconst hasKeys = \"keys\" in Object;\n\nexport const assign = hasKeys\n  ? (target, src) => {\n      for (const i of Object.keys(src)) {\n        target[i] = src[i];\n      }\n      return target;\n    }\n  : (target, src) => {\n      for (const i in src) {\n        target[i] = src[i];\n      }\n      return target;\n    };\n\n/**\n *\n * @param {Array<Array<T>>} arr\n * @param {number} depth\n * @param {()=>T} map\n * @returns {Array<T>}\n */\nexport function flattenArray(arr, depth, map, removeHoles = false) {\n  const flattend = [];\n  const flat = (array, depth) => {\n    for (const el of array) {\n      if (Array.isArray(el) && depth > 0) {\n        flat(el, depth - 1);\n      } else {\n        if (!removeHoles || el != null) flattend.push(map ? map(el) : el);\n      }\n    }\n  };\n  flat(arr, ~~depth || 1);\n  return flattend;\n}\n\nexport const EMPTY_OBJ = {};\nexport const EMPTY_ARR = [];\n\nexport const $ = {\n  /**\n   *\n   * @param {import(\"./ui\").UiElement} dom\n   * @param {string} key\n   * @param {any} value\n   */\n  setAttribute(dom, key, value) {\n    if (key in dom) {\n      return (dom[key] = value == null ? \"\" : value);\n    } else {\n      if (value == null) return dom.removeAttribute(key);\n      return dom.setAttribute(key, value);\n    }\n  }\n};\n\nexport const isListener = attr => attr[0] === \"o\" && attr[1] === \"n\";\n\nexport function isStringLike(a) {\n  return typeof a === \"string\" || typeof a === \"number\";\n}\n\n/**\n *\n * @param {import(\"./ui\").UiElement} parentDom\n * @param {import(\"./ui\").UiNode} child\n */\nexport function appendChild(parentDom, child) {\n  if (child == null) return;\n  let vn;\n  let hasVn;\n  let insertBefore;\n  if ((hasVn = (vn = child._vNode) != null)) {\n    insertBefore = child._vNode._nextDomNode;\n  }\n  if (child.parentNode !== parentDom || vn._reorder) {\n    if (insertBefore != null) {\n      parentDom.insertBefore(child, insertBefore);\n    } else {\n      if (!vn._reorder) parentDom.appendChild(child);\n    }\n  }\n  /**@type {import(\"./ui\").UiNode} */\n  const prevDom = child.previousSibling;\n  /**@type {import(\"./ui\").UiNode} */\n  const nextDom = child.nextSibling;\n  if (prevDom == nextDom) return; //will only be equal if they are null\n  if (prevDom != null) {\n    const prevVnode = prevDom._vNode;\n    if (prevVnode != null && prevVnode._nextDomNode !== child) {\n      setDomNodeDescriptor(prevVnode, child, \"_nextDomNode\");\n    }\n  }\n\n  if (nextDom != null) {\n    const nextVnode = nextDom._vNode;\n    if (nextVnode != null && nextVnode._nextDomNode !== child)\n      setDomNodeDescriptor(nextVnode, child, \"_prevDomNode\");\n  }\n  if (hasVn) {\n    vn._prevDomNode = prevDom;\n    vn._nextDomNode = nextDom;\n  }\n}\n\n/**\n *\n * @param {import(\"./ui\").vNode} node\n * @param {import(\"./ui\").UiNode} sibDom\n * @param {\"_prevDomNode\"|\"_nextDomNode\"} desc\n */\nexport function setDomNodeDescriptor(node, sibDom, desc) {\n  if (node == null) return;\n  node[desc] = sibDom;\n  const c = node._prevVnode;\n  setDomNodeDescriptor(c, sibDom, desc);\n}\n","import { isListener, flattenArray, assign, EMPTY_OBJ } from \"./util.js\";\n\nexport function createElement(type, props, ...children) {\n  if (type == null || typeof type === \"boolean\") return null;\n  if (props == null) {\n    props = {};\n  } else {\n    props = assign({}, props);\n  }\n  if (children.length) {\n    children = flattenArray(children, Infinity);\n    props.children = children;\n  }\n  const ref = props.ref;\n  if (ref) delete props.ref;\n  const key = props.key;\n  if (key) delete props.key;\n  const events = {};\n  for (const i in props) {\n    if (isListener(i)) {\n      events[i.substr(2).toLowerCase()] = props[i];\n      // delete props[i];\n    }\n  }\n  return getVNode(type, props, events, key, ref);\n}\nexport function Fragment() {}\nexport function getVNode(type, props, events, key, ref) {\n  /**\n   * @type {import(\"./ui\").vNode}\n   */\n  const vnode = {\n    type,\n    props,\n    events,\n    key,\n    _reorder: false,\n    ref,\n    _children: null,\n    _dom: null,\n    _component: null,\n    __uAttr: null,\n    _nextDomNode: null,\n    _prevDomNode: null,\n    _prevVnode: null\n  };\n  return (vnode.__uAttr = vnode);\n}\n/**\n *\n * @param {any} nodeType\n * @returns {import(\"./ui\").vNode}\n */\nexport function toVnode(nodeType) {\n  if (nodeType == null || typeof nodeType === \"boolean\") {\n    return null;\n  }\n  if (typeof nodeType === \"string\" || typeof nodeType === \"number\") {\n    return getVNode(null, String(nodeType));\n  }\n  if (Array.isArray(nodeType)) {\n    return createElement(Fragment, null, nodeType);\n  }\n\n  // Clone vnode if it has already been used.\n  if (nodeType._dom != null) {\n    const vnode = getVNode(\n      nodeType.type,\n      nodeType.props,\n      nodeType.events,\n      nodeType.key,\n      null\n    );\n    vnode._dom = nodeType._dom;\n    return vnode;\n  }\n\n  return nodeType;\n}\n","import { EMPTY_OBJ, EMPTY_ARR, setDomNodeDescriptor } from \"./util.js\";\nimport { Fragment } from \"./create-element.js\";\n\nconst _rLifeCycle = (c, m, ...a) => {\n  c.__currentLifeCycle = m;\n  if (c[m] != null) {\n    try {\n      c[m](...a);\n    } catch (e) {\n      if (c.componentDidCatch != null) {\n        c.componentDidCatch(e);\n      } else {\n        throw e;\n      }\n    }\n  }\n};\n/**\n *\n * @param {import(\"./component\").default} c\n * @param {import(\"./ui\").lifeCycleMethod} method\n * @param {boolean} [recurses]\n */\nexport function runLifeCycle(c, method, ...args) {\n  if (!c) return;\n  c = _rLifeCycle(c, method, ...args);\n}\n\n/**\n *\n * @param {import(\"./ui\").vNode} node\n */\nexport function unmountDomTree(node) {\n  if (node === EMPTY_OBJ || node == null) return;\n  if (node._prevVnode) unmountDomTree(node._prevVnode);\n  const dom = node._dom;\n  const cc = node._component;\n  runLifeCycle(cc, \"componentWillUnmount\", true);\n  if (cc != null) cc.base = cc._vnode = null;\n  if (!dom) {\n    return;\n  }\n\n  if (node != null) {\n    if (node._nextDomNode != null)\n      setDomNodeDescriptor(node._nextDomNode._vNode, null, \"_prevDomNode\");\n    if (node._prevDomNode != null)\n      setDomNodeDescriptor(node._prevDomNode._vNode, null, \"_nextDomNode\");\n    for (const child of node._children || EMPTY_ARR) {\n      unmountDomTree(child);\n    }\n    node._prevVnode = node._component = node._dom = node._prevDomNode = node._nextDomNode = null;\n  }\n  if (Array.isArray(dom)) {\n    let d;\n    while ((d = node._children.pop())) {\n      removeNode(d);\n    }\n  } else {\n    removeNode(dom);\n  }\n  dom.onclick = dom._component = dom._listeners = dom._prevVnode = dom._vNode = null;\n}\n\n/**\n * @param {Node} node\n */\nexport function removeNode(node) {\n  const p = node.parentNode;\n  if (p) {\n    p.removeChild(node);\n  }\n}\nexport function commitMounts(mounts) {\n  let c;\n  while ((c = mounts.pop())) {\n    runLifeCycle(c, \"componentDidMount\");\n    c._didMount = true;\n  }\n}\n","import { $, EMPTY_OBJ, isListener } from \"../util.js\";\nimport { Fragment } from \"../create-element.js\";\n\n/**\n *\n * @param {import(\"../ui\").vNode} newVnode\n * @param {import(\"../ui\").vNode} oldVnode\n * @param {import(\"../ui\").UiNode} previousDom\n * @param {boolean} _DisableDiff\n \n \n */\nexport function diffDom(newVnode, oldVnode, previousDom, _DisableDiff) {\n  /**\n   * @type {import(\"../ui\").UiNode}\n   */\n  let el;\n  const type = newVnode.type;\n  // should be called when there is a type mismatch  or we are in a brand new vnode (nothing to diff againts)\n  if (_DisableDiff) {\n    if (typeof newVnode.props === \"string\") {\n      el = document.createTextNode(newVnode.props);\n    } else {\n      el = document.createElement(type);\n      diffAttributes(el, newVnode, EMPTY_OBJ);\n    }\n  } else {\n    const oldType = oldVnode.type;\n    if (type !== oldType) {\n      return diffDom(newVnode, null, null, true);\n    } else {\n      el = previousDom;\n      if (previousDom instanceof Text) {\n        const newVal = newVnode.props;\n        if (previousDom.nodeValue !== newVal) {\n          previousDom.nodeValue = newVal;\n        }\n      } else {\n        diffAttributes(el, newVnode, oldVnode);\n      }\n    }\n  }\n  if (newVnode._prevVnode != null) {\n    newVnode._prevVnode._dom = el;\n  }\n  return el;\n}\nconst isSafeAttr = attr => attr !== \"key\" && attr !== \"children\";\n/**\n *\n * @param {import(\"../ui\").UiElement} currentDom\n * @param {import(\"../ui\").vNode} currVnode\n * @param {boolean} hasOldReferenceDom\n * @param {import(\"../ui\").vNode} prevVnode\n */\nfunction diffAttributes(currentDom, currVnode, prevVnode) {\n  if (currentDom instanceof Text) return;\n  const newAttributes = currVnode.props;\n  const prevAttributes = currentDom.attributes;\n  const currEvents = currVnode.events;\n  const prevEvents = prevVnode != null ? prevVnode.events : EMPTY_OBJ;\n  for (let i = 0; i < prevAttributes.length; i++) {\n    const attr = prevAttributes[i].name;\n    if (!(attr in newAttributes)) {\n      $.setAttribute(currentDom, attr, null);\n    }\n  }\n  for (let attr in newAttributes) {\n    if (isListener(attr) || !isSafeAttr(attr)) continue;\n    let newValue = newAttributes[attr];\n    const oldValue =\n      attr in currentDom\n        ? currentDom[attr]\n        : (prevAttributes[attr] || EMPTY_OBJ).value;\n    attr = attr === \"class\" ? \"className\" : attr;\n    if (attr === \"className\" && Array.isArray(newValue)) {\n      newValue = newValue.join(\" \");\n    }\n    if (attr === \"style\") {\n      const st = currentDom.style;\n      if (typeof newValue === \"string\") {\n        st.cssText = newValue;\n      } else {\n        if (typeof oldValue === \"string\") {\n          st.cssText = \"\";\n        } else {\n          if (oldValue) {\n            oldValue.cssText = \"\";\n          }\n        }\n        for (const i in newValue) {\n          const prop = newValue[i];\n          if (!oldValue || prop !== oldValue[i]) {\n            st[i] = prop;\n          }\n        }\n      }\n      continue;\n    }\n    if (oldValue !== newValue) $.setAttribute(currentDom, attr, newValue);\n  }\n\n  // let clsattr = newAttributes.class || newAttributes.className;\n  // const oldClass = currentDom.className;\n  // if (oldClass && !clsattr) {\n  //   return void currentDom.removeAttribute(\"class\");\n  // }\n  // if (clsattr) {\n  //   if (typeof clsattr !== \"string\") {\n  //     clsattr = clsattr.join(\" \");\n  //   }\n  //   $.setAttribute(currentDom, \"class\", clsattr);\n  // }\n  diffEventListeners(currEvents, prevEvents, currentDom);\n}\n\n/**\n *\n * @param {Event} e\n * @this {import(\"../ui\").UiElement}\n */\nexport function eventListenerProxy(e) {\n  return this._listeners[e.type](e);\n}\n\n/**\n *\n * @param {import(\"../ui\").vNode['events']} newListeners\n * @param {import(\"../ui\").vNode['events']} oldListeners\n * @param {import(\"../ui\").UiElement} dom\n */\nexport function diffEventListeners(newListeners, oldListeners, dom) {\n  if (newListeners == oldListeners) return;\n  if (dom._listeners == null) {\n    dom._listeners = {};\n    dom.onclick = Fragment;\n  }\n  if (oldListeners == null) {\n    oldListeners = EMPTY_OBJ;\n  }\n  if (newListeners == null) {\n    newListeners = EMPTY_OBJ;\n  }\n  for (const event in newListeners) {\n    const listener = newListeners[event];\n    const oldListener = oldListeners[event];\n    if (oldListener !== listener && listener != null) {\n      dom.addEventListener(event, eventListenerProxy);\n      dom._listeners[event] = listener;\n    }\n  }\n  for (const evt in oldListeners) {\n    if (newListeners[evt] == null) {\n      delete dom._listeners[evt];\n      dom.removeEventListener(evt, eventListenerProxy);\n    }\n  }\n}\n","import { unmountDomTree } from \"../lifeCycleRunner.js\";\nimport { diff } from \"./index.js\";\nimport { appendChild } from \"../util.js\";\n\n/**\n *\n * @param {import(\"../ui\").vNode} newParentVnode\n * @param {import(\"../ui\").vNode['_children']} oldChildren\n * @param {import(\"../ui\").UiElement} parentDom\n * @param {object} context\n * @param {Array<import(\"../ui\").UiComponent>} mounts\n * @param {import(\"../ui\").UiComponent} previousComponent\n * @param {boolean} force\n */\n\nexport function diffChildren(\n  newParentVnode,\n  oldChildren,\n  parentDom,\n  context,\n  mounts,\n  previousComponent,\n  force\n) {\n  const newChildren = newParentVnode._children;\n  const newChildrenLength = newChildren.length;\n  const oldChildrenLength = oldChildren.length;\n  const retArr = [];\n  for (let i = 0; i < Math.max(newChildrenLength, oldChildrenLength); i++) {\n    const newChild = newChildren[i];\n    let oldChild = oldChildren[i];\n    let nextOldChild;\n    if (newChild == null) {\n      if (oldChild != null) {\n        unmountDomTree(oldChild);\n      }\n      continue;\n    }\n    if (oldChild == null && (nextOldChild = oldChildren[i + 1]) != null) {\n      const nextOldDom = nextOldChild._dom;\n      const nextDom = Array.isArray(nextOldDom) ? nextOldDom[0] : nextOldDom;\n      newChild._nextDomNode = nextDom;\n    }\n    const dom = diff(\n      parentDom,\n      newChild,\n      oldChild,\n      context,\n      mounts,\n      previousComponent,\n      force\n    );\n    if (!Array.isArray(dom)) {\n      appendChild(parentDom, dom);\n      retArr.push(dom);\n    }\n  }\n\n  return retArr;\n}\n","import { defer, assign, EMPTY_OBJ, appendChild } from \"./util.js\";\nimport { commitMounts } from \"./lifeCycleRunner.js\";\nimport { diff } from \"./diff/index.js\";\n/**\n * @type {Array<import(\"./ui\").UiComponent>}\n */\nconst RENDER_QUEUE = [];\nclass Component {\n  constructor(props, context) {\n    // /**\n    //  * @type {import(\"./ui\").vNode}\n    //  */\n    // this._vnode = null;\n    // /**\n    //  * @type {Component}\n    //  */\n    // this._previousComponent = null;\n    // /**\n    //  * @type {import(\"./ui\").lifeCycleMethod}\n    //  */\n    // this.__currentLifeCycle = null;\n    this.props = props;\n    this.context = context;\n  }\n  /**\n   * @param {import(\"./ui\").UiComponent['props']} props\n   * @param {import(\"./ui\").UiComponent['state']} state\n   * @returns {import(\"./ui\").vNode}\n   */\n  render(props, state) {\n    return;\n  }\n  setState(updater) {\n    const next =\n      typeof updater === \"function\"\n        ? (updater = updater(this._nextState, this.props))\n        : updater;\n    if (next == null) return;\n    this._nextState = assign({}, this.state || EMPTY_OBJ);\n    this._oldState = assign({}, this._nextState);\n    assign(this._nextState, next);\n    enqueueRender(this);\n    assign(this.state, this._nextState || EMPTY_OBJ);\n  }\n  forceUpdate(callback) {\n    const parentDom = this.parentDom;\n    const mounts = [];\n    if (parentDom) {\n      const force = callback !== false;\n      /**\n       * @type {import(\"./ui\").vNode}\n       */\n      const vn = this._vnode;\n      const _sibDom = vn != null ? vn._nextDomNode : null;\n\n      /**\n       * @type {import(\"./ui\").UiNode}\n       */\n      this.base = diff(parentDom, vn, vn, this.context, mounts, this, force);\n      if (this.base instanceof Node && !this.base.parentNode) {\n        appendChild(parentDom, this.base, _sibDom);\n      }\n    }\n    if (callback) callback();\n    commitMounts(mounts);\n  }\n}\nexport function enqueueRender(c) {\n  c._dirty = true;\n  if (RENDER_QUEUE.push(c) === 1) {\n    window.requestAnimationFrame != null\n      ? window.requestAnimationFrame(process)\n      : defer(process);\n  }\n}\n\nfunction process() {\n  let p;\n  RENDER_QUEUE.sort((x, y) => x._depth - y._depth);\n  while ((p = RENDER_QUEUE.pop())) {\n    p._nextState = null;\n    p._dirty = false;\n    p.forceUpdate(false);\n  }\n}\nexport default Component;\n","import { runLifeCycle } from \"../lifeCycleRunner.js\";\nimport Component from \"../component.js\";\nimport { assign, EMPTY_OBJ, EMPTY_ARR } from \"../util.js\";\nimport { toVnode } from \"../create-element.js\";\n\n/**\n *\n * @param {import(\"../ui\").vNode} newVnode\n * @param {import(\"../ui\").vNode} oldVnode\n * @param {import(\"../ui\").UiElement} parentDom\n * @param {Array<import(\"../ui\").UiComponent>} mounts\n * @param {object} context\n * @param {boolean} force\n */\nexport function toSimpleVnode(\n  newVnode,\n  oldVnode,\n  parentDom,\n  mounts,\n  context,\n  force,\n  previousComponent\n) {\n  /**\n   * @type {import(\"../ui\").UiComponent}\n   */\n  let c;\n  /**\n   * @type {import(\"../ui\").vNode}\n   */\n  let vnode;\n  let isNew;\n  const newType = newVnode.type;\n  if (oldVnode._component) {\n    c = newVnode._component = oldVnode._component;\n    c.base = newVnode._dom = oldVnode._dom;\n    c.props = newVnode.props;\n    c.context = context;\n    isNew = false;\n    if (!force) {\n      if (\n        c.shouldComponentUpdate != null &&\n        c.shouldComponentUpdate(newVnode.props, c.state) !== false\n      ) {\n      } else if (c.shouldComponentUpdate != null) {\n        return EMPTY_OBJ;\n      }\n    }\n  } else {\n    isNew = true;\n    if (newType.prototype && newType.prototype.render) {\n      c = newVnode._component = new newType(newVnode.props, context);\n      mounts.push(c);\n    } else {\n      c = new Component(newVnode.props, context);\n      newVnode._component = null;\n      c.constructor = newType;\n      c.render = getRenderer;\n    }\n  }\n  c.parentDom = parentDom;\n  if (c.state == null) c.state = {};\n  c._nextState = assign({}, c.state);\n  if (newType.getDerivedStateFromProps != null) {\n    assign(\n      c._nextState,\n      newType.getDerivedStateFromProps(newVnode.props, c._nextState) ||\n        EMPTY_OBJ\n    );\n    assign(c._oldState || (c._oldState = {}), c._nextState);\n  }\n\n  if (isNew) {\n    runLifeCycle(c, \"componentWillMount\");\n  } else {\n    runLifeCycle(\n      c,\n      \"componentWillUpdate\",\n      newVnode.props,\n      c._nextState,\n      context\n    );\n  }\n  c.state = c._nextState;\n  vnode = c._prevVnode = toVnode(c.render(newVnode.props, c.state));\n  if (vnode) {\n    vnode._dom = newVnode._dom;\n    vnode._reorder = newVnode._reorder;\n  } //we maybe rendering null\n  c._depth = previousComponent ? ~~previousComponent._depth + 1 : 0;\n  return vnode;\n}\n\nfunction getRenderer(props, _, context) {\n  return this.constructor(props, context);\n}\n","/**\n *  @TODO refactor loops and fix variable naming\n */\nimport { Fragment, toVnode } from \"../create-element.js\";\nimport { flattenArray, EMPTY_OBJ, EMPTY_ARR } from \"../util.js\";\nimport { unmountDomTree, runLifeCycle } from \"../lifeCycleRunner.js\";\nimport { diffDom } from \"./dom.js\";\nimport { diffChildren } from \"./children.js\";\nimport { toSimpleVnode } from \"./toSimpleVnode.js\";\n/**\n *\n * @param {import(\"../ui\").UiElement} parentDom\n * @param {import(\"../ui\").vNode} newVnode\n * @param {import(\"../ui\").vNode} oldVnode\n * @param {object} context\n * @param {Array<import(\"../ui\").UiComponent>} mounts\n * @param {import(\"../ui\").UiComponent} previousComponent\n * @param {boolean} force\n */\nexport function diff(\n  parentDom,\n  newVnode,\n  oldVnode,\n  context,\n  mounts,\n  previousComponent,\n  force\n) {\n  if (typeof newVnode === \"boolean\") newVnode = null;\n  if (\n    oldVnode == null ||\n    newVnode == null ||\n    oldVnode.type !== newVnode.type\n    // oldVnode.key !== newVnode.key no stable keys implementation\n  ) {\n    if (oldVnode != null && oldVnode !== EMPTY_OBJ) {\n      unmountDomTree(oldVnode);\n    }\n    if (newVnode == null) {\n      return null;\n    }\n    oldVnode = EMPTY_OBJ;\n  }\n  if (oldVnode != null && newVnode != null && newVnode._nextDomNode == null) {\n    newVnode._nextDomNode = oldVnode._nextDomNode;\n  }\n  const shouldGenerateNewTree = oldVnode === EMPTY_OBJ;\n\n  if (newVnode.__uAttr !== newVnode) {\n    console.warn(\"component not of expected type =>\", newVnode);\n    return null;\n  }\n\n  newVnode._children = flattenArray(\n    (newVnode.props && newVnode.props.children) || [],\n    Infinity,\n    toVnode\n  );\n  const newType = newVnode.type;\n  if (newType === Fragment || oldVnode.type === Fragment) {\n    if (newVnode.type !== Fragment) {\n      const oldSimilarChild = getSimilarChildTo(\n        newType,\n        oldVnode._children || EMPTY_ARR\n      );\n      const removeChildren = (oldVnode._children || EMPTY_ARR).filter(\n        x => x !== oldSimilarChild\n      );\n      for (const c of removeChildren) {\n        unmountDomTree(c);\n      }\n      return diff(\n        parentDom,\n        newVnode,\n        oldSimilarChild,\n        context,\n        mounts,\n        previousComponent,\n        force\n      );\n    } else {\n      return diffChildren(\n        newVnode,\n        shouldGenerateNewTree ? EMPTY_ARR : oldVnode._children || EMPTY_ARR,\n        parentDom,\n        context,\n        mounts,\n        previousComponent,\n        force\n      );\n    }\n  }\n  if (typeof newType === \"function\") {\n    let node;\n    node = toSimpleVnode(\n      newVnode,\n      oldVnode,\n      parentDom,\n      mounts,\n      context,\n      force,\n      previousComponent\n    );\n    if (newVnode._component != null) newVnode._component._vnode = newVnode;\n    if (node === EMPTY_OBJ) return null; //scu returned false\n    const dom = (newVnode._dom = diff(\n      parentDom,\n      node,\n      \"_prevVnode\" in oldVnode ? oldVnode._prevVnode : oldVnode,\n      context,\n      mounts,\n      newVnode._component,\n      force\n    ));\n    if (node == null) return;\n    node._dom = dom;\n    if (newVnode._component != null) newVnode._component.base = dom;\n    runLifeCycle(\n      newVnode._component,\n      \"componentDidUpdate\",\n      oldVnode.props,\n      (oldVnode._component || EMPTY_OBJ)._oldState\n    );\n    if (oldVnode._component != null) delete oldVnode._component._oldState;\n    newVnode._prevVnode = node;\n    if (dom != null && !Array.isArray(dom)) {\n      dom._vNode = newVnode;\n    }\n    return dom;\n  } else {\n    if (shouldGenerateNewTree) {\n      newVnode._dom = diffDom(newVnode, null, null, true);\n    } else {\n      newVnode._dom = diffDom(newVnode, oldVnode, oldVnode._dom, false);\n    }\n    if (previousComponent != null) {\n      previousComponent.base = newVnode._dom;\n    }\n  }\n  const dom = newVnode._dom;\n  if (!Array.isArray(dom)) dom._vNode = newVnode;\n  diffChildren(\n    newVnode,\n    shouldGenerateNewTree ? EMPTY_ARR : oldVnode._children || EMPTY_ARR,\n    dom,\n    context,\n    mounts,\n    newVnode._component,\n    force\n  );\n  return dom;\n}\n\n/**\n *\n * @param {import(\"../ui\").vNode['type']} type\n * @param {import(\"../ui\").vNode['_children']} childArr\n */\nfunction getSimilarChildTo(type, childArr) {\n  for (const child of childArr) {\n    if (child.type === type) {\n      return child;\n    }\n  }\n}\n","import { diff } from \"./diff/index.js\";\nimport { Fragment, createElement } from \"./create-element.js\";\nimport { commitMounts } from \"./lifeCycleRunner.js\";\n/**\n *\n * @param {import(\"./ui\").vNode} vn\n * @param {import(\"./ui\").UiElement} parentDom\n */\nexport function render(vn, parentDom) {\n  const vnode = createElement(Fragment, null, [vn]);\n  const mounts = [];\n  const oldVnode = parentDom._oldVnode;\n  parentDom._oldVnode = vn;\n  diff(\n    parentDom,\n    vnode,\n    oldVnode,\n    {},\n    mounts,\n    oldVnode == null ? null : oldVnode._component,\n    false,\n    null\n  );\n  commitMounts(mounts);\n}\n","import Component from \"../../component.js\";\nimport { createElement as h } from \"../../create-element.js\";\n\nclass AsyncComponent extends Component {\n  constructor(props, context) {\n    const { componentPromise, fallbackComponent, ..._props } = props;\n    super(_props, context);\n    this.state = {\n      ready: false,\n      componentPromise,\n      finalComponent: null,\n      fallbackComponent\n    };\n  }\n  static getDerivedStateFromProps(props, state) {\n    const s = state || {};\n    if (s.componentPromise === props.componentPromise) return s;\n    // we are still in a promise..let that load first or we will get stuck in an infinite loop\n    if (props.componentPromise != null) {\n      s.componentPromise = props.componentPromise;\n      s.ready = false;\n      s.finalComponent = null;\n    }\n    return s;\n  }\n  render(\n    { eager = true, loadComponent = false, ...props },\n    { ready, finalComponent }\n  ) {\n    if ((eager || loadComponent) && !ready) {\n      this.loadComponent();\n    }\n    if (ready) {\n      return h(finalComponent, props);\n    }\n    const { children, ..._props } = props;\n    return this.state.fallbackComponent != null\n      ? h(this.state.fallbackComponent, _props)\n      : _defaultLoader;\n  }\n\n  loadComponent() {\n    return this.state.componentPromise().then(ct => {\n      this.setState({ ready: true, finalComponent: ct });\n    });\n  }\n}\nconst _defaultLoader = h(\"div\", null, \"Loading..\");\nexport default AsyncComponent;\nexport { AsyncComponent as LazyComponent };\n","import Component from \"../../component.js\";\nimport { createElement as h, Fragment } from \"../../create-element.js\";\nimport { EMPTY_OBJ } from \"../../util.js\";\n/**\n * @type {Array<(e:PopStateEvent|null)=>any>}\n */\nconst _routerSubscriptions = [];\nexport const RouterSubscription = {\n  /**\n   * @param {(e:PopStateEvent|null)=>any} fun\n   */\n  subscribe(fun) {\n    if (!_routerSubscriptions.includes(fun)) _routerSubscriptions.push(fun);\n  },\n  unsubscribe(fun) {\n    for (let i = 0; i < _routerSubscriptions.length; i++) {\n      if (_routerSubscriptions[i] === fun)\n        return _routerSubscriptions.splice(i, 1);\n    }\n  },\n  /**\n   * @param {PopStateEvent|null} e\n   */\n  emit(e, options) {\n    for (const subscription of _routerSubscriptions) {\n      subscription(e, options);\n    }\n  },\n  unsubscribeAll() {\n    _routerSubscriptions.length = 0;\n  }\n};\n\nexport function loadURL(url) {\n  window.history.pushState(EMPTY_OBJ, document.title, url);\n  RouterSubscription.emit(url, { type: \"load\", native: false });\n}\nexport function redirect(url) {\n  window.history.replaceState(EMPTY_OBJ, document.title, url);\n  RouterSubscription.emit(url, { type: \"redirect\", native: false });\n}\nclass Router extends Component {\n  componentWillMount() {\n    RouterSubscription.subscribe(this._routeChangeHandler);\n    window.addEventListener(\"popstate\", RouterSubscription.emit);\n  }\n\n  componentWillUnmount() {\n    window.removeEventListener(\"popstate\", RouterSubscription.emit);\n    if (this.props.destroySubscriptionOnUnmount) {\n      RouterSubscription.unsubscribeAll();\n    }\n  }\n  absolute(path) {\n    return new URL(\n      path || \"\",\n      `${location.protocol}//${location.host}`\n    ).toString();\n  }\n  getCurrentComponent() {\n    const currentPath = Router.getPath;\n    return this.getPathComponent(currentPath) || [];\n  }\n  _routeChangeHandler() {\n    const [component, match] = this.getCurrentComponent();\n    this.component = this.match = null;\n    this.setState({ component, match });\n  }\n  _notFoundComponent() {\n    return h(\n      \"div\",\n      null,\n      `The Requested URL \"${this.absolute(Router.getPath)}\" was not found`\n    );\n  }\n  static get getPath() {\n    return location.pathname;\n  }\n  static get getQs() {\n    return location.search;\n  }\n  /**\n   * @returns {[any,RegExpExecArray]}\n   */\n  getPathComponent(route) {\n    for (const obj of this.state.routes) {\n      const { regex, component } = obj;\n      const match = regex.exec(route);\n      if (match) {\n        return [component, match];\n      }\n    }\n    return [];\n  }\n  initComponents(c) {\n    for (const child of c) {\n      if (child.props != null && child.props.path != null) {\n        this.state.routes.push({\n          regex: child.props.path,\n          component: child\n        });\n      }\n    }\n  }\n  /**\n   *\n   * @param {{children:Array<import(\"../ui\").vNode>}} routerProps\n   * @param {object} context\n   */\n  constructor(routerProps, context) {\n    let { children, fallbackComponent, ...props } = routerProps;\n    super(props, context);\n    fallbackComponent = fallbackComponent || this._notFoundComponent.bind(this);\n    this.state = { routes: [], fallbackComponent };\n    this.initComponents(children);\n    const [component, match] = this.getCurrentComponent();\n    this.component = component;\n    this.match = match;\n    this._routeChangeHandler = this._routeChangeHandler.bind(this);\n  }\n  render() {\n    /**\n     * @type {import(\"../../ui\").vNode}\n     */\n    let c;\n    if (this.state.component != null && this.state.match != null) {\n      c = this.state.component;\n    } else if (this.component) {\n      c = this.component;\n    } else {\n      c = h(this.state.fallbackComponent, this.props);\n    }\n    if (!c.__uAttr) c = h(c, { match: this.state.match, ...this.props });\n    return h(Fragment, null, c);\n  }\n}\n\nexport function A(props) {\n  const { native, href, onClick, ...p } = props;\n  const setProps = p;\n  setProps.href = href;\n  if (!native && href != null) {\n    setProps.onClick = e => onLinkClick(e, props.href, onClick);\n  }\n  return h(\"a\", setProps);\n}\n/**\n *\n * @param {MouseEvent} e\n */\nfunction onLinkClick(e, href, func) {\n  if (e.altKey || e.ctrlKey || e.metaKey || e.shiftKey) {\n    return;\n  }\n  if (e.stopImmediatePropagation) {\n    e.stopImmediatePropagation();\n  }\n  if (e.stopPropagation) {\n    e.stopPropagation();\n  }\n  e.preventDefault();\n  loadURL(href);\n  if (func != null) func(e, href);\n}\nexport function absolutePath(route) {\n  return RegExp(`^${route}(/?)$`);\n}\n\nexport default Router;\n"],"names":["defer","Promise","prototype","then","bind","resolve","setTimeout","assign","Object","target","src","keys","const","i","flattenArray","arr","depth","map","removeHoles","flattend","flat","array","el","Array","isArray","push","EMPTY_OBJ","EMPTY_ARR","$","setAttribute","dom","key","value","removeAttribute","isListener","attr","appendChild","parentDom","child","vn","hasVn","insertBefore","_vNode","_nextDomNode","parentNode","_reorder","prevDom","previousSibling","nextDom","nextSibling","prevVnode","setDomNodeDescriptor","nextVnode","_prevDomNode","node","sibDom","desc","_prevVnode","createElement","type","props","children","length","Infinity","ref","events","substr","toLowerCase","getVNode","Fragment","vnode","_children","_dom","_component","__uAttr","toVnode","nodeType","String","_rLifeCycle","c","m","__currentLifeCycle","a","e","componentDidCatch","runLifeCycle","method","args","unmountDomTree","cc","base","_vnode","d","pop","removeNode","onclick","_listeners","p","removeChild","commitMounts","mounts","_didMount","diffDom","newVnode","oldVnode","previousDom","_DisableDiff","document","createTextNode","diffAttributes","Text","newVal","nodeValue","isSafeAttr","currentDom","currVnode","newAttributes","prevAttributes","attributes","currEvents","prevEvents","name","let","newValue","oldValue","join","st","style","cssText","prop","newListeners","oldListeners","event","listener","addEventListener","eventListenerProxy","evt","removeEventListener","diffEventListeners","this","diffChildren","newParentVnode","oldChildren","context","previousComponent","force","newChildren","newChildrenLength","oldChildrenLength","retArr","Math","max","newChild","oldChild","nextOldChild","nextOldDom","diff","RENDER_QUEUE","Component","constructor","process","sort","x","y","_depth","_nextState","_dirty","forceUpdate","getRenderer","_","shouldGenerateNewTree","console","warn","newType","oldSimilarChild","childArr","getSimilarChildTo","filter","isNew","shouldComponentUpdate","state","render","getDerivedStateFromProps","_oldState","toSimpleVnode","_oldVnode","setState","updater","next","window","requestAnimationFrame","callback","Node","AsyncComponent","ready","componentPromise","finalComponent","fallbackComponent","s","ref$1","eager","loadComponent","h","_defaultLoader","ct","_routerSubscriptions","RouterSubscription","subscribe","fun","includes","unsubscribe","splice","emit","options","subscription","unsubscribeAll","loadURL","url","history","pushState","title","native","redirect","replaceState","Router","routerProps","_notFoundComponent","routes","initComponents","getCurrentComponent","component","match","_routeChangeHandler","componentWillMount","componentWillUnmount","destroySubscriptionOnUnmount","absolute","path","URL","location","toString","getPathComponent","getPath","pathname","getQs","search","route","obj","exec","regex","A","setProps","href","onClick","func","altKey","ctrlKey","metaKey","shiftKey","stopImmediatePropagation","stopPropagation","preventDefault","onLinkClick","absolutePath","RegExp"],"mappings":"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"}