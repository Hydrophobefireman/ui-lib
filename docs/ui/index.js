var e="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,t={},n=[],o=t.constructor,r=t.hasOwnProperty,l="assign"in o?o.assign:function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e};function i(e,t,n,o){void 0===o&&(o=!1);var r=[],l=(e,t)=>{for(var i of e)Array.isArray(i)&&t>0?l(i,t-1):o&&null==i||r.push(n?n(i):i)};return l(e,~~t||1),r}var a=(e,t,n)=>t in e?e[t]=null==n?"":n:null==n?e.removeAttribute(t):e.setAttribute(t,n),s=e=>"o"===e[0]&&"n"===e[1];function u(e,t){if(null!=t){var n,o,r;(o=null!=(n=t._vNode))&&(r=t._vNode._nextDomNode),(t.parentNode!==e||n._reorder)&&(null!=r?e.insertBefore(t,r):n._reorder||e.appendChild(t));var l=t.previousSibling,i=t.nextSibling;if(l!=i){if(null!=l){var a=l._vNode;null!=a&&a._nextDomNode!==t&&p(a,t,"_nextDomNode")}if(null!=i){var s=i._vNode;null!=s&&s._nextDomNode!==t&&p(s,t,"_prevDomNode")}o&&(n._prevDomNode=l,n._nextDomNode=i)}}}function p(e,t,n){null!=e&&(e[n]=t,p(e._prevVnode,t,n))}function c(e,n){for(var o=arguments.length,r=new Array(o>2?o-2:0),l=2;l<o;l++)r[l-2]=arguments[l];if(null==e||"boolean"==typeof e)return null;null==n&&(n=t);var a=n.ref,u=n.key;n=v(n),(r.length||(r=[n.children]))&&(r=i(r,Infinity),n.children=r);var p={};for(var c in n)s(c)&&(p[c.substr(2).toLowerCase()]=n[c]);return m(e,n,p,u,a)}function d(){}function m(e,t,n,o,r){var l={type:"string"==typeof e?e.toLowerCase():e,props:t,events:n,key:o,_reorder:!1,ref:r,_children:null,_dom:null,_component:null,__uAttr:null,_nextDomNode:null,_prevDomNode:null,_prevVnode:null};return l.__uAttr=l}function f(e){if(null==e||"boolean"==typeof e)return null;if("string"==typeof e||"number"==typeof e)return m(null,String(e));if(Array.isArray(e))return c(d,null,e);if(null!=e._dom){var t=m(e.type,e.props,e.events,e.key,null);return t._dom=e._dom,t}return e}var _={key:1,ref:1};function v(e){var t={};for(var n in e)null==_[n]&&(t[n]=e[n]);return t}function h(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];if(e&&(e.__currentLifeCycle=t,null!=e[t])){var l=function(){e[t].apply(e,o)};if("undefined"!=typeof Promise)return Promise.resolve(l()).catch(t=>e.componentDidCatch&&e.componentDidCatch(t));try{l()}catch(t){e.componentDidCatch&&e.componentDidCatch(t)}}}function y(e){if(e!==t&&null!=e){e._prevVnode&&y(e._prevVnode);var o=e._dom,r=e._component;if(h(r,"componentWillUnmount",!0),null!=r&&(r.base=r._vnode=null),o){for(var l of(null!=e._nextDomNode&&p(e._nextDomNode._vNode,null,"_prevDomNode"),null!=e._prevDomNode&&p(e._prevDomNode._vNode,null,"_nextDomNode"),e._children||n))y(l);if(e._prevVnode=e._component=e._dom=e._prevDomNode=e._nextDomNode=null,Array.isArray(o))for(var i;i=n.pop.call(o||n);)g(i);else g(o);o.onclick=o._component=o._listeners=o._prevVnode=o._vNode=o._currentProps=null}}}function g(e){var t=e.parentNode;t&&t.removeChild(e)}function C(e){for(var t;t=e.pop();)h(t,"componentDidMount"),t._didMount=!0}function b(e,n,o,r){var l,i=e.type;if(r)"string"==typeof e.props?l=document.createTextNode(e.props):N(l=document.createElement(i),e,t);else{if(i!==n.type)return b(e,null,null,!0);if(l=o,o instanceof Text){var a=e.props;o.nodeValue!==a&&(o.nodeValue=a)}else N(l,e,n)}return null!=e._prevVnode&&(e._prevVnode._dom=l),l}var x=e=>"key"!==e&&"children"!==e;function N(e,n,o){if(!(e instanceof Text)){var r=n.props,l=e._currentProps||t;e._currentProps=r;var i=n.events,u=null!=o?o.events:t;for(var p in l)p in r||a(e,p,null);for(var c in r)if(!s(c)&&x(c)){var m=r[c],f=l[c];m!==f&&("className"!==(c="class"===c?"className":c)?"style"!==c?a(e,c,m):P(e,m,f):D(e,m,f))}!function(e,n,o){if(e!=n){for(var r in null==o._listeners&&(o.onclick=d,o._listeners={}),null==n&&(n=t),null==e&&(e=t),e){var l=e[r];n[r]!==l&&null!=l&&(o.addEventListener(r,S),o._listeners[r]=l)}for(var i in n)null==e[i]&&(delete o._listeners[i],o.removeEventListener(i,S))}}(i,u,e)}}function D(e,t,n){var o=Array.isArray;o(t)&&(t=t.join(" ").trim()),o(n)&&(n=n.join(" ").trim()),t!==n&&a(e,"className",t)}function P(e,t,n){n=n||"";var o=e.style;if("string"!=typeof t){var r="string"==typeof n;if(r)o.cssText="";else for(var l in n)l in t||(o[l]="");for(var i in t){var a=t[i];(r||a!==n[i])&&(o[i]=a)}}else o.cssText=t}function S(e){return this._listeners[e.type].call(this,e)}function A(e,n,o,r,l,i,a){for(var s=e._children,p=s.length,c=n.length,d=[],m=0;m<Math.max(p,c);m++){var f=s[m],_=n[m]||t,v=void 0;if(null!=f){var h=f._nextDomNode||_._nextDomNode;if(_===t&&null!=(v=w(n,c,m))){var g=v._dom;h=Array.isArray(g)?g[0]:g,f._reorder=!0}f._nextDomNode=h;var C=T(o,f,_,r,l,i,a);Array.isArray(C)||(u(o,C),d.push(C))}else null!=_&&y(_)}return d}function w(e,t,n){for(var o;n<t&&!(o=e[n]);n++);return o}var k=[];class V{constructor(e,t){this.props=e,this.context=t,this.state={}}render(e,t){}setState(n){this._nextState=l({},this.state||t),this._oldState=l({},this._nextState);var o,r="function"==typeof n?n=n(this._nextState,this.props):n;null!=r&&(l(this._nextState,r),l(this.state,this._nextState),(o=this)._dirty=!0,1===k.push(o)&&(null!=window.requestAnimationFrame?window.requestAnimationFrame(U):e(U)))}forceUpdate(e){var t=this.parentDom,n=[];if(t){var o=this._vnode;this.base=T(t,o,o,this.context,n,this,!1!==e),this.base instanceof Node&&!this.base.parentNode&&u(t,this.base)}e&&e(),C(n)}}function U(){var e;for(k.sort((e,t)=>e._depth-t._depth);e=k.pop();)e._dirty&&(e._nextState=null,e._dirty=!1,e.forceUpdate(!1))}function L(e,t,n){return this.constructor(e,n)}function T(e,o,r,i,a,s,u){if("boolean"==typeof o&&(o=null),null==r||null==o||r.type!==o.type){if(null!=r&&r!==t&&y(r),null==o)return null;r=t}var p=r===t;if(o.__uAttr!==o)return console.warn("component not of expected type =>",o),null;o._children=F(o);var c=o.type;if(c===d||r.type===d)return A(o,p?n:r._children||n,e,i,a,s,u);if("function"==typeof c){var m,_=function(e,n,o,r,i,a,s){var u,p,c,d=e.type;if(n._component){if((u=e._component=n._component).base=e._dom=n._dom,u.props=e.props,u.context=i,c=!1,!a)if(null!=u.shouldComponentUpdate&&!1!==u.shouldComponentUpdate(e.props,u.state));else if(null!=u.shouldComponentUpdate)return{node:t,shouldUpdate:!1}}else c=!0,d.prototype&&d.prototype.render?(u=e._component=new d(e.props,i),r.push(u)):(u=new V(e.props,i),e._component=null,u.constructor=d,u.render=L);return u.parentDom=o,null==u.state&&(u.state={}),u._nextState=l({},u.state),null!=d.getDerivedStateFromProps&&(l(u._nextState,d.getDerivedStateFromProps(e.props,u._nextState)||t),l(u._oldState||(u._oldState={}),u._nextState)),c?h(u,"componentWillMount"):h(u,"componentWillUpdate",e.props,u._nextState,i),u.state=u._nextState,(p=u._prevVnode=f(u.render(e.props,u.state)))&&(p._dom=e._dom,p._reorder=e._reorder),u._depth=s?1+~~s._depth:0,{node:p,shouldUpdate:!c}}(o,r,e,a,i,u,s);m=_.node;var v=_.shouldUpdate;if(null!=o._component&&(o._component._vnode=o),m===t)return null;var g=o._dom=T(e,m,"_prevVnode"in r?r._prevVnode:r,i,a,o._component,u);if(null==m)return;return m._dom=g,null!=o._component&&(o._component.base=g),v&&h(o._component,"componentDidUpdate",r.props,(r._component||t)._oldState),null!=r._component&&delete r._component._oldState,m!==o._prevVnode&&(o._prevVnode=m),null==g||Array.isArray(g)||(g._vNode=o),g}o._dom=p?b(o,null,null,!0):b(o,r,r._dom,!1),null!=s&&(s.base=o._dom);var C=o._dom;return C._vNode=o,A(o,p?n:r._children||n,C,i,a,o._component,u),C}function F(e){return i(e.props&&e.props.children||n,Infinity,f)}function O(e,t){var n=c(d,null,e);if(t.hasChildNodes())return M(t,n);var o=[];T(t,n,null,{},o,null,!1),C(o)}function E(e){if("#comment"!==e.nodeName){if(e instanceof Text)return e.nodeValue;var t=c(e.tagName,function(e){for(var t={},n=e.length,o=0;o<n;o++){var r=e[o];t[r.name]=r.value}return t}(e.attributes),Array.from(e.childNodes).map(E));return t._children=F(t),t._dom=e,e._vNode=t,t}}function M(e,t){var n=Array.from(e.childNodes),o=c(d,null,n.map(E));o._dom=n,o._children=F(o);var r=[];T(e,t,o,{},r,null,!1),C(r)}function j(){return(j=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function W(e,t){if(null==e)return{};var n,o,r={},l=Object.keys(e);for(o=0;o<l.length;o++)t.indexOf(n=l[o])>=0||(r[n]=e[n]);return r}class H extends V{constructor(e,t){var{componentPromise:n,fallbackComponent:o}=e;super(e,t),this.state={ready:!1,componentPromise:n,finalComponent:null,fallbackComponent:o}}static getDerivedStateFromProps(e,t){var n=t||{};return n.componentPromise===e.componentPromise||null!=e.componentPromise&&(n.componentPromise=e.componentPromise,n.ready=!1,n.finalComponent=null),n}render(e,t){var{eager:n=!0,loadComponent:o=!1}=r,r=W(r,["eager","loadComponent","componentPromise","fallbackComponent"]),{ready:l,finalComponent:i}=t;if(!n&&!o||l||this.loadComponent(),l)return c(i,r);var a=W(r,["children"]);return null!=this.state.fallbackComponent?c(this.state.fallbackComponent,a):I}loadComponent(){return this.state.componentPromise().then(e=>{this.setState({ready:!0,finalComponent:e})})}}var I=c("div",null,"Loading.."),K=[],R={subscribe(e){K.includes(e)||K.push(e)},unsubscribe(e){for(var t=0;t<K.length;t++)if(K[t]===e)return K.splice(t,1)},emit(e,t){for(var n of K)n(e,t)},unsubscribeAll(){K.length=0}};function q(e){window.history.pushState(t,document.title,e),R.emit(e,{type:"load",native:!1})}function Q(e){window.history.replaceState(t,document.title,e),R.emit(e,{type:"redirect",native:!1})}class B extends V{static __emitter(){R.emit(B.getPath+B.getQs,{type:"popstate",native:!0})}componentWillMount(){R.subscribe(this._routeChangeHandler),window.addEventListener("popstate",B.__emitter)}componentWillUnmount(){window.removeEventListener("popstate",B.__emitter),this.props.destroySubscriptionOnUnmount&&R.unsubscribeAll()}absolute(e){return new URL(e||"",location.protocol+"//"+location.host).toString()}getCurrentComponent(){return this.getPathComponent(B.getPath)||[]}_routeChangeHandler(){var[e,t]=this.getCurrentComponent();this.setState({component:e,match:t})}_notFoundComponent(){return c("div",null,'The Requested URL "'+this.absolute(B.getPath)+'" was not found')}static get getPath(){return location.pathname}static get getQs(){return location.search}getPathComponent(e){for(var t of this.state.routes){var{regex:n,component:o}=t,r=n.exec(e);if(r)return[o,r]}return[]}initComponents(e){var t=[];for(var n of e)null!=n.props&&null!=n.props.path&&t.push({regex:n.props.path,component:n});return t}constructor(e,t){var{children:n,fallbackComponent:o}=e;super(W(e,["children","fallbackComponent"]),t),o=o||this._notFoundComponent.bind(this),this.state={routes:this.initComponents(n),fallbackComponent:o};var[r,l]=this.getCurrentComponent();this.state.component=r,this.state.match=l,this._routeChangeHandler=this._routeChangeHandler.bind(this)}componentDidMount(){}render(){var e,t=W(this.props,["children"]),n=j({match:this.state.match},t);return null!=this.state.component&&null!=this.state.match?l((e=this.state.component).props,n):e=c(this.state.fallbackComponent,n),e.__uAttr||(e=c(e,n)),c(d,null,e)}}function $(e){var{native:t,href:n,onClick:o}=e,r=W(e,["native","href","onClick"]);return r.href=n,t||null==n||(r.onClick=t=>function(e,t,n){e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),q(t),null!=n&&n(e,t))}(t,e.href,o)),c("a",r)}function z(e){return RegExp("^"+e+"(/?)$")}export default V;export{$ as A,H as AsyncComponent,V as Component,d as Fragment,B as Router,R as RouterSubscription,z as absolutePath,c as createElement,c as h,M as hydrate,q as loadURL,Q as redirect,O as render};
//# sourceMappingURL=ui-lib.modern.js.map
