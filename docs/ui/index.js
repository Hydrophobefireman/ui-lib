function e(e,t,o){if(!(null==e||e instanceof Text||t===o)){for(var r in null==e._listeners&&(e._listeners={}),null==t&&(t=d),null==o&&(o=d),o)r in t||(delete e._listeners[r],e.removeEventListener(r,n));for(var i in t){var l=t[i],a=o[i];a!==l&&(null==a&&e.addEventListener(i,n),e._listeners[i]=l)}}}function n(e){return this._listeners[e.type].call(this,e)}var t={key:1,ref:1,children:1},o={value:1,checked:1};function r(e,n,t){t=t||"";var o=e.style;if("string"!=typeof n){var r="string"==typeof t;if(r)o.cssText="";else for(var i in t)i in n||(o[i]="");for(var l in n){var a=n[l];(r||a!==t[l])&&(o[l]=a)}}else o.cssText=n}function i(e,n,t){var o=Array.isArray;o(n)&&(n=n.join(" ").trim()),o(t)&&(t=t.join(" ").trim()),n!==t&&s(e,"className",n)}function l(e,n,t){u(e,n,t,"_renders"),u(e,n,t,"_renderedBy")}var a={_dom:"_FragmentDomNodeChildren",_FragmentDomNodeChildren:"_dom"};function u(e,n,t,o){for(var r=e,i=a[n];r;)i&&(r[i]=null),r[n]=t,r=r[o]}function s(e,n,t){return n in e?e[n]=null==t?"":t:null==t?e.removeAttribute(n):e.setAttribute(n,t)}function p(e,n){null!=n&&u(e,"_parentDom",n,"_renderedBy")}var d={},c=[];function m(e,n,t){return function e(n,t,o,r){if(!n)return t;for(var i=0;i<n.length;i++){var l=n[i];Array.isArray(l)?e(l,t,o,r):r&&null==l||t.push(o?o(l):l)}return t}(e,[],n,t)}function f(e){return"o"===e[0]&&"n"===e[1]}var h=d.hasOwnProperty,_="assign"in Object?d.constructor.assign:function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)h.call(t,o)&&(e[o]=t[o])}return e},v=Object.freeze({});function y(e,n){if(null==e||"boolean"==typeof e)return null;null==n&&(n=d);var t,o=n.ref,r=n.key,i="string"==typeof e?{}:null;n=C(n,i);for(var l=arguments.length,a=new Array(l>2?l-2:0),u=2;u<l;u++)a[u-2]=arguments[u];return a.length&&null==n.children&&(t=m(a)),null!=n.children&&(t=m([n.children])),n.children=t,b(e,n,i,r,o)}function b(e,n,t,o,r){var i={type:"string"==typeof e?e.toLowerCase():e,props:n,events:t,key:o,ref:r,_dom:null,_children:null,_component:null,_nextSibDomVNode:null,_renders:null,_renderedBy:null,_prevSibDomVNode:null,_FragmentDomNodeChildren:null,_parentDom:null,_depth:0,__self:null};return i.__self=i,i}var g=function(){},S={key:1,ref:1};function C(e,n){var t={},o=null!=n;for(var r in e)null==S[r]&&(t[r]=e[r],o&&f(r)&&(n[r.substr(2).toLowerCase()]=e[r]));return t}function N(e){return null==e||"boolean"==typeof e?y(v):"string"==typeof e||"number"==typeof e?b(null,String(e)):Array.isArray(e)?y(g,null,e):null!=e._dom?b(e.type,e.props,e.events,e.key,null):e}var D="undefined"!=typeof Promise,x="undefined"!=typeof requestAnimationFrame,V=setTimeout,P=D?Promise.prototype.then.bind(Promise.resolve()):V,k={deferImplementation:P,scheduleRender:x?function(e){return requestAnimationFrame(e)}:P,eagerlyHydrate:!0,beforeHookRender:null},w=[],A=[];function F(){B(w)}function U(){B(A)}function B(e){for(var n;n=e.pop();)O(n)}function L(e){var n=e.name;return"componentDidMount"===n?w.push(e):"componentDidUpdate"===n?A.push(e):void O(e)}function O(e){var n=e.args,t=e.bind,o=e.name;t._lastLifeCycleMethod=o;var r=t[o],i=!!t.componentDidCatch;if(D)Promise.resolve().then(()=>r&&r.apply(t,n)).catch(e=>{if(i)return t.componentDidCatch(e);throw e});else try{r.apply(t,n)}catch(e){if(i)return t.componentDidCatch(e);throw e}}function j(n,t){if(null!=n&&n!==d){j(n._renders,t);var o=n._component;t||null==o||(o.setState=g,o._VNode=null,L({name:"componentWillUnmount",bind:o}));var r=n._children;if(r)for(;r.length;)j(r.pop(),t);!function(n,t){if(!t&&"function"!=typeof n.type){var o=n._dom;null!=o&&(!(n.type===v)&&e(o,null,n.events),function(e){E(M,e)}(o),function(e){if(null!=e){var n=e.parentNode;n&&n.removeChild(e)}}(o))}!function(e,n){if(null!=e){if(!n){var t=e._nextSibDomVNode;if(null!=t){var o=t._dom,r=o&&o.previousSibling;l(t,"_prevSibDomVNode",r&&r._VNode)}var i=e._prevSibDomVNode;if(null!=i){var a=i._dom,u=a&&a.nextSibling;l(i,"_nextSibDomVNode",u&&u._VNode)}}E(R,e)}}(n,t)}(n,t)}}var M={_VNode:1,_listeners:1,onclick:1},R={events:1,_FragmentDomNodeChildren:1,_children:1,_component:1,_depth:1,_dom:1,_nextSibDomVNode:1,_prevSibDomVNode:1,_renderedBy:1,_renders:1,_parentDom:1};function E(e,n){if(null!=n)for(var t in e)n[t]=null}function H(e,n,t,o){return function(e,n,t,o,r){for(var i=e.type===g,l=n.length,a=Math.max(l,t.length),s=0;s<a;s++){var p=n[s]||(s<l?y(v):null),c=t[s]||d;if(null==c._nextSibDomVNode){var m=i?e._nextSibDomVNode:null;null!=m&&u(p,"_nextSibDomVNode",m,"_renderedBy")}J(p,c,o,null,r),i&&null!=p&&T(e,p,s)}if(i&&l){var f=e._children;u(e,"_nextSibDomVNode",f[l-1]._nextSibDomVNode,"_renderedBy"),u(e,"_prevSibDomVNode",f[0]._prevSibDomVNode,"_renderedBy")}}(e,e._children||c,(n||d)._children||c,t,o)}function T(e,n,t){var o=n&&(n._dom||n._FragmentDomNodeChildren),r=e._FragmentDomNodeChildren;null==r&&u(e,"_FragmentDomNodeChildren",r=[],"_renderedBy"),r[t]=o}var W=[];class K{constructor(e){this.state={},this.props=e}render(e,n){return null}setState(e){if(this._oldState=_({},this.state),this._nextState=_({},this.state),"function"==typeof e){var n=e(this._nextState,this.props);if(null==n)return;_(this._nextState,n)}else _(this._nextState,e);var t;this.state=this._nextState,(t=this)._dirty=!0,1===W.push(t)&&k.scheduleRender(q)}forceUpdate(e){var n=!1!==e;this.base=J(this._VNode,_({},this._VNode),this._VNode._parentDom,n,{depth:this._depth}),"function"==typeof e&&e(),F(),U()}}function q(){var e;for(W.sort((e,n)=>e._depth-n._depth);e=W.pop();)e._dirty&&(e._dirty=!1,e.forceUpdate(!1))}var I=e=>"function"==typeof e&&e!==g,Q={_nextSibDomVNode:1,_prevSibDomVNode:1};function z(e,n){if(n._renders=e,e)for(var t in e._renderedBy=n,Q)e[t]=n[t]}function $(e){return this.constructor(e)}function G(e,n,t){var o,r=_({},e.state||d,e._nextState||d),i=null!=(o=n.getDerivedStateFromProps)?_({},o(t.props,r)):null;i&&_(r,i),e._nextState=r}function J(n,a,u,c,h){if("boolean"==typeof n&&(n=null),null==a&&(a=d),null!=n){if(n===d)return null;if(!((_=n)&&_.__self===_||(console.warn("component not of expected type =>",_),0)))return null;var _;if(a===n)return n._dom;!function(e,n){if(n!==d&&null!=e&&null!=n){var t=n._prevSibDomVNode;null==e._prevSibDomVNode&&null!=t&&(l(e,"_prevSibDomVNode",t),l(t,"_nextSibDomVNode",e));var o=n._nextSibDomVNode;null==e._nextSibDomVNode&&null!=o&&(l(e,"_nextSibDomVNode",o),l(o,"_prevSibDomVNode",e))}}(n,a);var y=a.type,b=n.type,S=I(b);b===y&&S&&(n._component=a._component),b!==y&&(j(a),a=d);var C,D,x=n;if("string"!=typeof n.props&&b!==v&&(n=function(e,n,t,o){var r;return null!=e&&I(r=e.type)?(n=n||d,function(e){var n=e.prototype;return!(!n||!n.render)}(r)?function(e,n,t,o){var r,i=e.type,l=e._component;if(null!=l){if(null!=l.shouldComponentUpdate&&!t&&!1===l.shouldComponentUpdate(e.props,l._nextState||l.state))return d;G(l,i,e),L({bind:l,name:"componentWillUpdate",args:[e.props,l._nextState]}),r="componentDidUpdate"}else r="componentDidMount",l=new i(e.props),e._component=l,G(l,i,e),L({bind:l,name:"componentWillMount"}),l._depth=++o.depth;l._VNode=e;var a=l._oldState,u=n.props;l.state=l._nextState,l._oldState=null,l._nextState=null,l.props=e.props;var s=N(l.render(l.props,l.state));return L({bind:l,name:r,args:"componentDidUpdate"===r?[u,a]:[]}),z(s,e),s}(e,n,t,o):function(e,n){var t,o,r=e.type;return e._component?o=e._component:(o=new K(e.props),e._component=o,o.render=$,o.constructor=r,o.props=e.props),t=N(o.render(e.props)),o._depth=++n.depth,z(t,e),t}(e,o)):e}(n,a,c,h)),I(a.type)&&(a=a._renders),n!==x)return J(n,a,u,c,h);n._children=null==(D=(C=n).props.children)&&C.type!==g?[]:m([D],N),y=a.type,b=n.type,p(n,u);var V=a;return b===g?H(n,a,u,h):(y!==b&&(a=null),function(n,a,u){var c,m=(a=a||d)===d,h=a._dom;(c=n.type!==a.type||null==h?function(e){if("string"==typeof e.props)return document.createTextNode("");var n=e.type;if(n===v)return document.createComment("");var t=document.createElement(n);return t.onclick=g,t}(n):h)._VNode=n,function(n,l,a){if(l.type!==v){if(a=a||d,"string"==typeof l.props)return function(e,n,t){return n===t||(e.nodeValue=n)}(n,l.props,a.props);var u=a.props||d,p=l.props;null!=u&&function(e,n,t){for(var o in n)o in t||s(e,o,null)}(n,u,p),function(e,n,l){for(var a in l)if(!f(a)&&!(a in t)){var u=l[a],p=o[a]?e[a]:n[a];u!==p&&("className"!==(a="class"===a?"className":a)?"style"!==a?s(e,a,u):r(e,u,p):i(e,u,p))}}(n,u,p),e(n,l.events,a.events)}}(c,n,m?null:a),l(n,"_dom",c),function e(n,t){n&&(null!=n._component?n._component.base=t:e(n._renderedBy,t))}(n,c),m&&function(e,n,t){var o=function(e){if(e){var n=e._dom;if(n)return n;var t=e._FragmentDomNodeChildren;return t?function e(n){for(var t=0;t<n.length;t++){var o=n[t];if(Array.isArray(o)){var r=e(o);if(r)return r}else if(o)return o}}(t):void 0}}(e._nextSibDomVNode),r=e._dom;r&&(function(e,n,t){var o,r=!0;n&&n!==e&&(r=!1,o=n),!r&&o?t.insertBefore(e,o):t.appendChild(e)}(r,o,n),function(e){var n=e._dom;null==e._parentDom&&p(e,n.parentNode);var t=e._nextSibDomVNode;if(null==t){var o=n.nextSibling;null!=o&&(t=o._VNode)}l(t,"_prevSibDomVNode",e),l(e,"_nextSibDomVNode",t);var r=e._prevSibDomVNode;if(null==r){var i=n.previousSibling;null!=i&&(r=i._VNode)}l(r,"_nextSibDomVNode",e),l(e,"_prevSibDomVNode",r)}(e))}(n,u)}(n,a,u),H(n,a,n._dom,h)),j(V,!0),n._dom}j(a)}function X(e,n){var t=y(g,null,e);n.hasChildNodes()&&function(e){for(var n;n=e.firstChild;)e.removeChild(n)}(n),J(t,null,n,!1,{depth:0}),F(),U()}function Y(){return(Y=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e}).apply(this,arguments)}function Z(e,n){if(null==e)return{};var t,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)n.indexOf(t=i[o])>=0||(r[t]=e[t]);return r}class ee extends K{constructor(e,n){var{componentPromise:t,fallbackComponent:o}=e;super(e,n),this.state={ready:!1,componentPromise:t,finalComponent:null,fallbackComponent:o}}static getDerivedStateFromProps(e,n){var t=n||{};return t.componentPromise===e.componentPromise||null!=e.componentPromise&&(t.componentPromise=e.componentPromise,t.ready=!1,t.finalComponent=null),t}render(e,n){var{eager:t=!0,loadComponent:o=!1}=e,r=Z(e,["eager","loadComponent","componentPromise","fallbackComponent"]),{ready:i,finalComponent:l}=n;if(!t&&!o||i||this.loadComponent(),i)return y(l,r);var a=Z(r,["children"]);return null!=this.state.fallbackComponent?y(this.state.fallbackComponent,a):ne}loadComponent(){return this.state.componentPromise().then(e=>{this.setState({ready:!0,finalComponent:e})})}}var ne=y("div",null,"Loading.."),te=[],oe={subscribe(e){te.includes(e)||te.push(e)},unsubscribe(e){for(var n=0;n<te.length;n++)if(te[n]===e)return te.splice(n,1)},emit(e,n){for(var t of te)t(e,n)},unsubscribeAll(){te.length=0}};function re(e){window.history.pushState(0,0,e),oe.emit(e,{type:"load",native:!1})}function ie(e){window.history.replaceState(0,0,e),oe.emit(e,{type:"redirect",native:!1})}class le extends K{static __emitter(){oe.emit(le.getPath+le.getQs,{type:"popstate",native:!0})}componentWillMount(){oe.subscribe(this._routeChangeHandler),window.addEventListener("popstate",le.__emitter)}componentWillUnmount(){window.removeEventListener("popstate",le.__emitter),this.props.destroySubscriptionOnUnmount&&oe.unsubscribeAll()}absolute(e){return new URL(e||"",location.protocol+"//"+location.host).toString()}getCurrentComponent(){return this.getPathComponent(le.getPath)||[]}_routeChangeHandler(){var[e,n]=this.getCurrentComponent();this.setState({component:e,match:n})}_notFoundComponent(){return y("div",null,'The Requested URL "'+this.absolute(le.getPath)+'" was not found')}static get getPath(){return location.pathname}static get getQs(){return location.search}getPathComponent(e){for(var n of this.state.routes){var{regex:t,component:o}=n,r=t.exec(e);if(r)return[o,r]}return[]}initComponents(e){var n=[];for(var t of e)null!=t.props&&null!=t.props.path&&n.push({regex:t.props.path,component:t});return n}constructor(e,n){var{children:t,fallbackComponent:o}=e;super(Z(e,["children","fallbackComponent"]),n),o=o||this._notFoundComponent.bind(this),this.state={routes:this.initComponents(t),fallbackComponent:o};var[r,i]=this.getCurrentComponent();this.state.component=r,this.state.match=i,this._routeChangeHandler=this._routeChangeHandler.bind(this)}componentDidMount(){}render(){var e,n=Z(this.props,["children"]),t=Y({match:this.state.match},n);return null!=this.state.component&&null!=this.state.match?_((e=this.state.component).props,t):e=y(this.state.fallbackComponent,t),e.__self||(e=y(e,t)),y(g,null,e)}}function ae(e){var{native:n,href:t,onClick:o}=e,r=Z(e,["native","href","onClick"]);return r.href=t,n||null==t||(r.onClick=n=>function(e,n,t){e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),re(n),null!=t&&t(e,n))}(n,e.href,o)),y("a",r)}function ue(e){return RegExp("^"+e+"(/?)$")}export default K;export{ae as A,ee as AsyncComponent,K as Component,g as Fragment,le as Router,oe as RouterSubscription,ue as absolutePath,k as config,y as createElement,y as h,re as loadURL,ie as redirect,X as render};
//# sourceMappingURL=ui-lib.modern.js.map
