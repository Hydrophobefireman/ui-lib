var t="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e="keys"in Object?function(t,e){for(var n=0,o=Object.keys(e);n<o.length;n+=1){var r=o[n];t[r]=e[r]}return t}:function(t,e){for(var n in e)t[n]=e[n];return t};function n(t,e,n,o){void 0===o&&(o=!1);var r=[],l=function(t,e){for(var i=0,a=t;i<a.length;i+=1){var u=a[i];Array.isArray(u)&&e>0?l(u,e-1):o&&null==u||r.push(n?n(u):u)}};return l(t,~~e||1),r}var o={},r=[],l={setAttribute:function(t,e,n){return e in t?t[e]=null==n?"":n:null==n?t.removeAttribute(e):t.setAttribute(e,n)}},i=function(t){return"o"===t[0]&&"n"===t[1]};function a(t,e){if(null!=e){var n,o,r;(o=null!=(n=e._vNode))&&(r=e._vNode._nextDomNode),(e.parentNode!==t||n._reorder)&&(null!=r?t.insertBefore(e,r):n._reorder||t.appendChild(e));var l=e.previousSibling,i=e.nextSibling;if(l!=i){if(null!=l){var a=l._vNode;null!=a&&a._nextDomNode!==e&&u(a,e,"_nextDomNode")}if(null!=i){var p=i._vNode;null!=p&&p._nextDomNode!==e&&u(p,e,"_prevDomNode")}o&&(n._prevDomNode=l,n._nextDomNode=i)}}}function u(t,e,n){null!=t&&(t[n]=e,u(t._prevVnode,e,n))}function p(t,o){for(var r=[],l=arguments.length-2;l-- >0;)r[l]=arguments[l+2];if(null==t||"boolean"==typeof t)return null;o=null==o?{}:e({},o),r.length&&(r=n(r,Infinity),o.children=r);var a=o.ref;a&&delete o.ref;var u=o.key;u&&delete o.key;var p={};for(var s in o)i(s)&&(p[s.substr(2).toLowerCase()]=o[s]);return c(t,o,p,u,a)}function s(){}function c(t,e,n,o,r){var l={type:t,props:e,events:n,key:o,_reorder:!1,ref:r,_children:null,_dom:null,_component:null,__uAttr:null,_nextDomNode:null,_prevDomNode:null,_prevVnode:null};return l.__uAttr=l}function d(t){if(null==t||"boolean"==typeof t)return null;if("string"==typeof t||"number"==typeof t)return c(null,String(t));if(Array.isArray(t))return p(s,null,t);if(null!=t._dom){var e=c(t.type,t.props,t.events,t.key,null);return e._dom=t._dom,e}return t}var f=function(t,e){for(var n=[],o=arguments.length-2;o-- >0;)n[o]=arguments[o+2];if(t.__currentLifeCycle=e,null!=t[e])try{t[e].apply(t,n)}catch(e){if(null==t.componentDidCatch)throw e;t.componentDidCatch(e)}};function m(t,e){for(var n=[],o=arguments.length-2;o-- >0;)n[o]=arguments[o+2];t&&(t=f.apply(void 0,[t,e].concat(n)))}function _(t){if(t!==o&&null!=t){t._prevVnode&&_(t._prevVnode);var e=t._dom,n=t._component;if(m(n,"componentWillUnmount",!0),null!=n&&(n.base=n._vnode=null),e){if(null!=t){null!=t._nextDomNode&&u(t._nextDomNode._vNode,null,"_prevDomNode"),null!=t._prevDomNode&&u(t._prevDomNode._vNode,null,"_nextDomNode");for(var l=0,i=t._children||r;l<i.length;l+=1)_(i[l]);t._prevVnode=t._component=t._dom=t._prevDomNode=t._nextDomNode=null}if(Array.isArray(e))for(var a;a=t._children.pop();)h(a);else h(e);e.onclick=e._component=e._listeners=e._prevVnode=e._vNode=null}}}function h(t){var e=t.parentNode;e&&e.removeChild(t)}function v(t){for(var e;e=t.pop();)m(e,"componentDidMount"),e._didMount=!0}function y(t,e,n,r){var l,i=t.type;if(r)"string"==typeof t.props?l=document.createTextNode(t.props):b(l=document.createElement(i),t,o);else{if(i!==e.type)return y(t,null,null,!0);if(l=n,n instanceof Text){var a=t.props;n.nodeValue!==a&&(n.nodeValue=a)}else b(l,t,e)}return null!=t._prevVnode&&(t._prevVnode._dom=l),l}var g=function(t){return"key"!==t&&"children"!==t};function b(t,e,n){if(!(t instanceof Text)){for(var r=e.props,a=t.attributes,u=e.events,p=null!=n?n.events:o,c=0;c<a.length;c++){var d=a[c].name;d in r||l.setAttribute(t,d,null)}for(var f in r)if(!i(f)&&g(f)){var m=r[f],_=f in t?t[f]:(a[f]||o).value;if("className"===(f="class"===f?"className":f)&&Array.isArray(m)&&(m=m.join(" ")),"style"!==f)_!==m&&l.setAttribute(t,f,m);else{var h=t.style;if("string"==typeof m)h.cssText=m;else for(var v in"string"==typeof _?h.cssText="":_&&(_.cssText=""),m){var y=m[v];_&&y===_[v]||(h[v]=y)}}}!function(t,e,n){if(t!=e){for(var r in null==n._listeners&&(n._listeners={},n.onclick=s),null==e&&(e=o),null==t&&(t=o),t){var l=t[r];e[r]!==l&&null!=l&&(n.addEventListener(r,x),n._listeners[r]=l)}for(var i in e)null==t[i]&&(delete n._listeners[i],n.removeEventListener(i,x))}}(u,p,t)}}function x(t){return this._listeners[t.type](t)}function C(t,e,n,o,r,l,i){for(var u=t._children,p=u.length,s=e.length,c=[],d=0;d<Math.max(p,s);d++){var f=u[d],m=e[d],h=void 0;if(null!=f){if(null==m&&null!=(h=e[d+1])){var v=h._dom,y=Array.isArray(v)?v[0]:v;f._nextDomNode=y}var g=P(n,f,m,o,r,l,i);Array.isArray(g)||(a(n,g),c.push(g))}else null!=m&&_(m)}return c}var N=[],D=function(t,e){this.props=t,this.context=e};function S(){var t;for(N.sort(function(t,e){return t._depth-e._depth});t=N.pop();)t._nextState=null,t._dirty=!1,t.forceUpdate(!1)}function A(t,e,n){return this.constructor(t,n)}function P(t,l,i,a,u,p,c){if("boolean"==typeof l&&(l=null),null==i||null==l||i.type!==l.type){if(null!=i&&i!==o&&_(i),null==l)return null;i=o}null!=i&&null!=l&&null==l._nextDomNode&&(l._nextDomNode=i._nextDomNode);var f=i===o;if(l.__uAttr!==l)return console.warn("component not of expected type =>",l),null;l._children=n(l.props&&l.props.children||[],Infinity,d);var h=l.type;if(h===s||i.type===s){if(l.type!==s){for(var v=function(t,e){for(var n=0,o=i._children||r;n<o.length;n+=1){var l=o[n];if(l.type===t)return l}}(h),g=0,b=(i._children||r).filter(function(t){return t!==v});g<b.length;g+=1)_(b[g]);return P(t,l,v,a,u,p,c)}return C(l,f?r:i._children||r,t,a,u,p,c)}if("function"==typeof h){var x;if(x=function(t,n,r,l,i,a,u){var p,s,c,f=t.type;if(n._component){if((p=t._component=n._component).base=t._dom=n._dom,p.props=t.props,p.context=i,c=!1,!a)if(null!=p.shouldComponentUpdate&&!1!==p.shouldComponentUpdate(t.props,p.state));else if(null!=p.shouldComponentUpdate)return o}else c=!0,f.prototype&&f.prototype.render?(p=t._component=new f(t.props,i),l.push(p)):(p=new D(t.props,i),t._component=null,p.constructor=f,p.render=A);return p.parentDom=r,null==p.state&&(p.state={}),p._nextState=e({},p.state),null!=f.getDerivedStateFromProps&&(e(p._nextState,f.getDerivedStateFromProps(t.props,p._nextState)||o),e(p._oldState||(p._oldState={}),p._nextState)),c?m(p,"componentWillMount"):m(p,"componentWillUpdate",t.props,p._nextState,i),p.state=p._nextState,(s=p._prevVnode=d(p.render(t.props,p.state)))&&(s._dom=t._dom,s._reorder=t._reorder),p._depth=u?1+~~u._depth:0,s}(l,i,t,u,a,c,p),null!=l._component&&(l._component._vnode=l),x===o)return null;var N=l._dom=P(t,x,"_prevVnode"in i?i._prevVnode:i,a,u,l._component,c);if(null==x)return;return x._dom=N,null!=l._component&&(l._component.base=N),m(l._component,"componentDidUpdate",i.props,(i._component||o)._oldState),null!=i._component&&delete i._component._oldState,l._prevVnode=x,null==N||Array.isArray(N)||(N._vNode=l),N}l._dom=f?y(l,null,null,!0):y(l,i,i._dom,!1),null!=p&&(p.base=l._dom);var S=l._dom;return Array.isArray(S)||(S._vNode=l),C(l,f?r:i._children||r,S,a,u,l._component,c),S}function k(t,e){var n=p(s,null,[t]),o=[],r=e._oldVnode;e._oldVnode=t,P(e,n,r,{},o,null==r?null:r._component,!1),v(o)}function w(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&-1===e.indexOf(o)&&(n[o]=t[o]);return n}D.prototype.render=function(t,e){},D.prototype.setState=function(n){var r,l="function"==typeof n?n=n(this._nextState,this.props):n;null!=l&&(this._nextState=e({},this.state||o),this._oldState=e({},this._nextState),e(this._nextState,l),(r=this)._dirty=!0,1===N.push(r)&&(null!=window.requestAnimationFrame?window.requestAnimationFrame(S):t(S)),e(this.state,this._nextState||o))},D.prototype.forceUpdate=function(t){var e=this.parentDom,n=[];if(e){var o=this._vnode;this.base=P(e,o,o,this.context,n,this,!1!==t),this.base instanceof Node&&!this.base.parentNode&&a(e,this.base)}t&&t(),v(n)};var V=function(t){function e(e,n){var o=e.componentPromise,r=e.fallbackComponent,l=w(e,["componentPromise","fallbackComponent"]);t.call(this,l,n),this.state={ready:!1,componentPromise:o,finalComponent:null,fallbackComponent:r}}return t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e,e.getDerivedStateFromProps=function(t,e){var n=e||{};return n.componentPromise===t.componentPromise?n:(null!=t.componentPromise&&(n.componentPromise=t.componentPromise,n.ready=!1,n.finalComponent=null),n)},e.prototype.render=function(t,e){var n=t.eager;void 0===n&&(n=!0);var o=t.loadComponent;void 0===o&&(o=!1);var r=w(t,["eager","loadComponent"]),l=e.ready,i=e.finalComponent;if(!n&&!o||l||this.loadComponent(),l)return p(i,r);var a=w(r,["children"]);return null!=this.state.fallbackComponent?p(this.state.fallbackComponent,a):O},e.prototype.loadComponent=function(){var t=this;return this.state.componentPromise().then(function(e){t.setState({ready:!0,finalComponent:e})})},e}(D),O=p("div",null,"Loading..");function U(t,e){var n={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&-1===e.indexOf(o)&&(n[o]=t[o]);return n}var j=[],L={subscribe:function(t){j.includes(t)||j.push(t)},unsubscribe:function(t){for(var e=0;e<j.length;e++)if(j[e]===t)return j.splice(e,1)},emit:function(t,e){for(var n=0,o=j;n<o.length;n+=1)(0,o[n])(t,e)},unsubscribeAll:function(){j.length=0}};function T(t){window.history.pushState(o,document.title,t),L.emit(t,{type:"load",native:!1})}function F(t){window.history.replaceState(o,document.title,t),L.emit(t,{type:"redirect",native:!1})}var E=function(t){function e(e,n){var o=e.children,r=e.fallbackComponent,l=U(e,["children","fallbackComponent"]);t.call(this,l,n),r=r||this._notFoundComponent.bind(this),this.state={routes:[],fallbackComponent:r},this.initComponents(o);var i=this.getCurrentComponent(),a=i[1];this.component=i[0],this.match=a,this._routeChangeHandler=this._routeChangeHandler.bind(this)}t&&(e.__proto__=t),(e.prototype=Object.create(t&&t.prototype)).constructor=e;var n={getPath:{configurable:!0},getQs:{configurable:!0}};return e.prototype.componentWillMount=function(){L.subscribe(this._routeChangeHandler),window.addEventListener("popstate",L.emit)},e.prototype.componentWillUnmount=function(){window.removeEventListener("popstate",L.emit),this.props.destroySubscriptionOnUnmount&&L.unsubscribeAll()},e.prototype.absolute=function(t){return new URL(t||"",location.protocol+"//"+location.host).toString()},e.prototype.getCurrentComponent=function(){return this.getPathComponent(e.getPath)||[]},e.prototype._routeChangeHandler=function(){var t=this.getCurrentComponent(),e=t[0],n=t[1];this.component=this.match=null,this.setState({component:e,match:n})},e.prototype._notFoundComponent=function(){return p("div",null,'The Requested URL "'+this.absolute(e.getPath)+'" was not found')},n.getPath.get=function(){return location.pathname},n.getQs.get=function(){return location.search},e.prototype.getPathComponent=function(t){for(var e=0,n=this.state.routes;e<n.length;e+=1){var o=n[e],r=o.component,l=o.regex.exec(t);if(l)return[r,l]}return[]},e.prototype.initComponents=function(t){for(var e=0,n=t;e<n.length;e+=1){var o=n[e];null!=o.props&&null!=o.props.path&&this.state.routes.push({regex:o.props.path,component:o})}},e.prototype.render=function(){var t;return(t=null!=this.state.component&&null!=this.state.match?this.state.component:this.component?this.component:p(this.state.fallbackComponent,this.props)).__uAttr||(t=p(t,Object.assign({},{match:this.state.match},this.props))),p(s,null,t)},Object.defineProperties(e,n),e}(D);function M(t){var e=t.native,n=t.href,o=t.onClick,r=U(t,["native","href","onClick"]);return r.href=n,e||null==n||(r.onClick=function(e){return function(t,e,n){t.altKey||t.ctrlKey||t.metaKey||t.shiftKey||(t.stopImmediatePropagation&&t.stopImmediatePropagation(),t.stopPropagation&&t.stopPropagation(),t.preventDefault(),T(e),null!=n&&n(t,e))}(e,t.href,o)}),p("a",r)}function W(t){return RegExp("^"+t+"(/?)$")}export default D;export{k as render,D as Component,p as createElement,s as Fragment,p as h,V as AsyncComponent,E as Router,T as loadURL,F as redirect,L as RouterSubscription,M as A,W as absolutePath};
//# sourceMappingURL=ui-lib.mjs.map
