var e="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,t="keys"in Object?function(e,t){for(var n=0,o=Object.keys(t);n<o.length;n++){var r=o[n];e[r]=t[r]}return e}:function(e,t){for(var n in t)e[n]=t[n];return e};function n(e,t,n,o){void 0===o&&(o=!1);var r=[];return function e(t,i){var l=t,a=Array.isArray(l),u=0;for(l=a?l:l[Symbol.iterator]();;){var s;if(a){if(u>=l.length)break;s=l[u++]}else{if((u=l.next()).done)break;s=u.value}var p=s;Array.isArray(p)&&i>0?e(p,i-1):o&&null==p||r.push(n?n(p):p)}}(e,~~t||1),r}var o={},r=[],i={setAttribute:function(e,t,n){return t in e?e[t]=null==n?"":n:null==n?e.removeAttribute(t):e.setAttribute(t,n)}},l=function(e){return"o"===e[0]&&"n"===e[1]};function a(e,t){if(null!=t){var n,o,r;(o=null!=(n=t._vNode))&&(r=t._vNode._nextDomNode),(t.parentNode!==e||n._reorder)&&(null!=r?e.insertBefore(t,r):n._reorder||e.appendChild(t));var i=t.previousSibling,l=t.nextSibling;if(i!=l){if(null!=i){var a=i._vNode;null!=a&&a._nextDomNode!==t&&u(a,t,"_nextDomNode")}if(null!=l){var s=l._vNode;null!=s&&s._nextDomNode!==t&&u(s,t,"_prevDomNode")}o&&(n._prevDomNode=i,n._nextDomNode=l)}}}function u(e,t,n){null!=e&&(e[n]=t,u(e._prevVnode,t,n))}function s(e,o){for(var r=arguments.length,i=new Array(r>2?r-2:0),a=2;a<r;a++)i[a-2]=arguments[a];if(null==e||"boolean"==typeof e)return null;o=null==o?{}:t({},o),i.length&&(i=n(i,Infinity),o.children=i);var u=o.ref;u&&delete o.ref;var s=o.key;s&&delete o.key;var p={};for(var f in o)l(f)&&(p[f.substr(2).toLowerCase()]=o[f]);return c(e,o,p,s,u)}function p(){}function c(e,t,n,o,r){var i={type:e,props:t,events:n,key:o,_reorder:!1,ref:r,_children:null,_dom:null,_component:null,__uAttr:null,_nextDomNode:null,_prevDomNode:null,_prevVnode:null};return i.__uAttr=i}function f(e){if(null==e||"boolean"==typeof e)return null;if("string"==typeof e||"number"==typeof e)return c(null,String(e));if(Array.isArray(e))return s(p,null,e);if(null!=e._dom){var t=c(e.type,e.props,e.events,e.key,null);return t._dom=e._dom,t}return e}var d=function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];if(e.__currentLifeCycle=t,null!=e[t])try{var i=function(){return e[t].apply(e,o)};return"function"==typeof Promise?Promise.resolve(i()).catch((function(t){return e.componentDidCatch(t)})):i()}catch(t){if(null==e.componentDidCatch)throw t;e.componentDidCatch(t)}};function m(e,t){if(e){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];d.apply(void 0,[e,t].concat(o))}}function v(e){if(e!==o&&null!=e){e._prevVnode&&v(e._prevVnode);var t=e._dom,n=e._component;if(m(n,"componentWillUnmount",!0),null!=n&&(n.base=n._vnode=null),t){if(null!=e){null!=e._nextDomNode&&u(e._nextDomNode._vNode,null,"_prevDomNode"),null!=e._prevDomNode&&u(e._prevDomNode._vNode,null,"_nextDomNode");var i=e._children||r,l=Array.isArray(i),a=0;for(i=l?i:i[Symbol.iterator]();;){var s;if(l){if(a>=i.length)break;s=i[a++]}else{if((a=i.next()).done)break;s=a.value}v(s)}e._prevVnode=e._component=e._dom=e._prevDomNode=e._nextDomNode=null}if(Array.isArray(t))for(var p;p=e._children.pop();)_(p);else _(t);t.onclick=t._component=t._listeners=t._prevVnode=t._vNode=null}}}function _(e){var t=e.parentNode;t&&t.removeChild(e)}function h(e){for(var t;t=e.pop();)m(t,"componentDidMount"),t._didMount=!0}function y(e,t,n,r){var i,l=e.type;if(r)"string"==typeof e.props?i=document.createTextNode(e.props):g(i=document.createElement(l),e,o);else{if(l!==t.type)return y(e,null,null,!0);if(i=n,n instanceof Text){var a=e.props;n.nodeValue!==a&&(n.nodeValue=a)}else g(i,e,t)}return null!=e._prevVnode&&(e._prevVnode._dom=i),i}var b=function(e){return"key"!==e&&"children"!==e};function g(e,t,n){if(!(e instanceof Text)){for(var r=t.props,a=e.attributes,u=t.events,s=null!=n?n.events:o,c=0;c<a.length;c++){var f=a[c].name;f in r||i.setAttribute(e,f,null)}for(var d in r)if(!l(d)&&b(d)){var m=r[d],v=(d="class"===d?"className":d)in e?e[d]:e.getAttribute(d);if("className"===d&&Array.isArray(m))m=m.join(" ");else if("style"===d){var _=e.style;if("string"==typeof m)_.cssText=m;else for(var h in"string"==typeof v?_.cssText="":v&&(v.cssText=""),m){var y=m[h];v&&y===v[h]||(_[h]=y)}continue}v!==m&&i.setAttribute(e,d,m)}!function(e,t,n){if(e!=t){for(var r in null==n._listeners&&(n._listeners={},n.onclick=p),null==t&&(t=o),null==e&&(e=o),e){var i=e[r];t[r]!==i&&null!=i&&(n.addEventListener(r,x),n._listeners[r]=i)}for(var l in t)null==e[l]&&(delete n._listeners[l],n.removeEventListener(l,x))}}(u,s,e)}}function x(e){return this._listeners[e.type](e)}function C(e,t,n,r,i,l,u){for(var s=e._children,p=s.length,c=t.length,f=[],d=0;d<Math.max(p,c);d++){var m=s[d],_=t[d]||o,h=void 0;if(null!=m){var y=m._nextDomNode||_._nextDomNode;if(_===o&&null!=(h=A(t,c,d))){var b=h._dom;y=Array.isArray(b)?b[0]:b,m._reorder=!0}m._nextDomNode=y;var g=P(n,m,_,r,i,l,u);Array.isArray(g)||(a(n,g),f.push(g))}else null!=_&&v(_)}return f}function A(e,t,n){for(var o;n<t&&!(o=e[n]);n++);return o}var N=[],k=function(){function n(e,t){this.props=e,this.context=t,this.state={}}var r=n.prototype;return r.render=function(e,t){},r.setState=function(n){this._nextState=t({},this.state||o),this._oldState=t({},this._nextState);var r,i="function"==typeof n?n=n(this._nextState,this.props):n;null!=i&&(t(this._nextState,i),t(this.state,this._nextState),(r=this)._dirty=!0,1===N.push(r)&&(null!=window.requestAnimationFrame?window.requestAnimationFrame(S):e(S)))},r.forceUpdate=function(e){var t=this.parentDom,n=[];if(t){var o=this._vnode;this.base=P(t,o,o,this.context,n,this,!1!==e),this.base instanceof Node&&!this.base.parentNode&&a(t,this.base)}e&&e(),h(n)},n}();function S(){var e;for(N.sort((function(e,t){return e._depth-t._depth}));e=N.pop();)e._dirty&&(e._nextState=null,e._dirty=!1,e.forceUpdate(!1))}function D(e,t,n){return this.constructor(e,n)}function P(e,i,l,a,u,s,c,d){if("boolean"==typeof i&&(i=null),null==l||null==i||l.type!==i.type){if(null!=l&&l!==o&&v(l),null==i)return null;l=o}var _=l===o;if(i.__uAttr!==i)return console.warn("component not of expected type =>",i),null;i._children=n(i.props&&i.props.children||r,Infinity,f);var h=i.type;if(h===p||l.type===p)return C(i,_?r:l._children||r,e,a,u,s,c);if("function"==typeof h){var b,g=function(e,n,r,i,l,a,u){var s,p,c,d=e.type;if(n._component){if((s=e._component=n._component).base=e._dom=n._dom,s.props=e.props,s.context=l,c=!1,!a)if(null!=s.shouldComponentUpdate&&!1!==s.shouldComponentUpdate(e.props,s.state));else if(null!=s.shouldComponentUpdate)return{node:o,shouldUpdate:!1}}else c=!0,d.prototype&&d.prototype.render?(s=e._component=new d(e.props,l),i.push(s)):(s=new k(e.props,l),e._component=null,s.constructor=d,s.render=D);return s.parentDom=r,null==s.state&&(s.state={}),s._nextState=t({},s.state),null!=d.getDerivedStateFromProps&&(t(s._nextState,d.getDerivedStateFromProps(e.props,s._nextState)||o),t(s._oldState||(s._oldState={}),s._nextState)),c?m(s,"componentWillMount"):m(s,"componentWillUpdate",e.props,s._nextState,l),s.state=s._nextState,(p=s._prevVnode=f(s.render(e.props,s.state)))&&(p._dom=e._dom,p._reorder=e._reorder),s._depth=u?1+~~u._depth:0,{node:p,shouldUpdate:!c}}(i,l,e,u,a,c,s);b=g.node;var x=g.shouldUpdate;if(null!=i._component&&(i._component._vnode=i),b===o)return null;var A=i._dom=P(e,b,"_prevVnode"in l?l._prevVnode:l,a,u,i._component,c);if(null==b)return;return b._dom=A,null!=i._component&&(i._component.base=A),x&&m(i._component,"componentDidUpdate",l.props,(l._component||o)._oldState),null!=l._component&&delete l._component._oldState,i._prevVnode=b,null==A||Array.isArray(A)||(A._vNode=i),A}i._dom=_?y(i,null,null,!0):y(i,l,l._dom,!1),null!=s&&(s.base=i._dom);var N=i._dom;return N._vNode=i,C(i,_?r:l._children||r,N,a,u,i._component,c),N}function w(e,t){var n=s(p,null,e),o=[],r=t._oldVnode;t._oldVnode=e,P(t,n,r,{},o,null==r?null:r._component,!1),h(o)}function V(){return(V=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function U(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}function O(e,t){if(null==e)return{};var n,o,r={},i=Object.keys(e);for(o=0;o<i.length;o++)t.indexOf(n=i[o])>=0||(r[n]=e[n]);return r}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var j=function(e){function t(t,n){var o,r=t.componentPromise,i=t.fallbackComponent,l=O(t,["componentPromise","fallbackComponent"]);return(o=e.call(this,l,n)||this).state={ready:!1,componentPromise:r,finalComponent:null,fallbackComponent:i},o}U(t,e),t.getDerivedStateFromProps=function(e,t){var n=t||{};return n.componentPromise===e.componentPromise?n:(null!=e.componentPromise&&(n.componentPromise=e.componentPromise,n.ready=!1,n.finalComponent=null),n)};var n=t.prototype;return n.render=function(e,t){var n=e.eager,o=void 0===n||n,r=e.loadComponent,i=void 0!==r&&r,l=O(e,["eager","loadComponent"]),a=t.ready,u=t.finalComponent;if(!o&&!i||a||this.loadComponent(),a)return s(u,l);var p=O(l,["children"]);return null!=this.state.fallbackComponent?s(this.state.fallbackComponent,p):T},n.loadComponent=function(){var e=this;return this.state.componentPromise().then((function(t){e.setState({ready:!0,finalComponent:t})}))},t}(k),T=s("div",null,"Loading.."),E=[],F={subscribe:function(e){E.includes(e)||E.push(e)},unsubscribe:function(e){for(var t=0;t<E.length;t++)if(E[t]===e)return E.splice(t,1)},emit:function(e,t){var n=E,o=Array.isArray(n),r=0;for(n=o?n:n[Symbol.iterator]();;){var i;if(o){if(r>=n.length)break;i=n[r++]}else{if((r=n.next()).done)break;i=r.value}i(e,t)}},unsubscribeAll:function(){E.length=0}};function M(e){window.history.pushState(o,document.title,e),F.emit(e,{type:"load",native:!1})}function R(e){window.history.replaceState(o,document.title,e),F.emit(e,{type:"redirect",native:!1})}var W=function(e){U(o,e),o.__emitter=function(){F.emit(o.getPath+o.getQs,{type:"popstate",native:!0})};var t,n=o.prototype;function o(t,n){var o,r=t.children,i=t.fallbackComponent,l=O(t,["children","fallbackComponent"]);o=e.call(this,l,n)||this,i=i||o._notFoundComponent.bind(L(o)),o.state={routes:[],fallbackComponent:i},o.initComponents(r);var a=o.getCurrentComponent(),u=a[1];return o.component=a[0],o.match=u,o._routeChangeHandler=o._routeChangeHandler.bind(L(o)),o}return n.componentWillMount=function(){F.subscribe(this._routeChangeHandler),window.addEventListener("popstate",o.__emitter)},n.componentWillUnmount=function(){window.removeEventListener("popstate",o.__emitter),this.props.destroySubscriptionOnUnmount&&F.unsubscribeAll()},n.absolute=function(e){return new URL(e||"",location.protocol+"//"+location.host).toString()},n.getCurrentComponent=function(){return this.getPathComponent(o.getPath)||[]},n._routeChangeHandler=function(){var e=this.getCurrentComponent(),t=e[0],n=e[1];this.component=this.match=null,this.setState({component:t,match:n})},n._notFoundComponent=function(){return s("div",null,'The Requested URL "'+this.absolute(o.getPath)+'" was not found')},n.getPathComponent=function(e){var t=this.state.routes,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(o>=t.length)break;r=t[o++]}else{if((o=t.next()).done)break;r=o.value}var i=r.component,l=r.regex.exec(e);if(l)return[i,l]}return[]},n.initComponents=function(e){var t=e,n=Array.isArray(t),o=0;for(t=n?t:t[Symbol.iterator]();;){var r;if(n){if(o>=t.length)break;r=t[o++]}else{if((o=t.next()).done)break;r=o.value}null!=r.props&&null!=r.props.path&&this.state.routes.push({regex:r.props.path,component:r})}},(t=[{key:"getPath",get:function(){return location.pathname}},{key:"getQs",get:function(){return location.search}}])&&function(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}(o,t),n.render=function(){var e;return(e=null!=this.state.component&&null!=this.state.match?this.state.component:this.component?this.component:s(this.state.fallbackComponent,this.props)).__uAttr||(e=s(e,V({match:this.state.match},this.props))),s(p,null,e)},o}(k);function H(e){var t=e.native,n=e.href,o=e.onClick,r=O(e,["native","href","onClick"]);return r.href=n,t||null==n||(r.onClick=function(t){return function(e,t,n){e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||(e.stopImmediatePropagation&&e.stopImmediatePropagation(),e.stopPropagation&&e.stopPropagation(),e.preventDefault(),M(t),null!=n&&n(e,t))}(t,e.href,o)}),s("a",r)}function I(e){return RegExp("^"+e+"(/?)$")}export default k;export{H as A,j as AsyncComponent,k as Component,p as Fragment,W as Router,F as RouterSubscription,I as absolutePath,s as createElement,s as h,M as loadURL,R as redirect,w as render};
//# sourceMappingURL=ui-lib.modern.js.map
